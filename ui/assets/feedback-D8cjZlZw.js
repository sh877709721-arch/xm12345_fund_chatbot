const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BkZ1fbvE.js","assets/index-D7VafxmD.css"])))=>i.map(i=>d[i]);
import{Y as i,a9 as h,t as n}from"./index-BkZ1fbvE.js";async function g(t){try{const e=new FormData;return e.append("file",t),(await i.post("/v1/admin/feedback/upload-image",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){const a=e.response?.data?.detail||e.message||"上传图片失败";throw n.error(a),e}}async function w(t){try{const e=await i.post("/v1/admin/feedback/",t);return n.success("反馈提交成功，感谢您的宝贵意见！"),e.data}catch(e){const a=e.response?.data?.detail||e.message||"提交反馈失败";throw n.error(a),e}}async function b(t={}){const e=new URLSearchParams;e.append("page",(t.page||1).toString()),e.append("size",(t.size||10).toString()),t.content&&e.append("content",t.content),t.phone&&e.append("phone",t.phone),t.start_date&&e.append("start_date",t.start_date),t.end_date&&e.append("end_date",t.end_date);try{return(await i.get(`/v1/admin/feedback/?${e.toString()}`)).data}catch(a){throw console.error("获取反馈列表失败:",a),a}}async function k(t={}){const e=new URLSearchParams;t.content&&e.append("content",t.content),t.phone&&e.append("phone",t.phone),t.start_date&&e.append("start_date",t.start_date),t.end_date&&e.append("end_date",t.end_date);try{const a=(await h(async()=>{const{default:r}=await import("./index-BkZ1fbvE.js").then(m=>m.aD);return{default:r}},__vite__mapDeps([0,1]))).default,o="/znkfzs",c=localStorage.getItem("access_token"),p=await a.get(`${o}/v1/admin/feedback/export/excel?${e.toString()}`,{responseType:"blob",headers:c?{Authorization:`Bearer ${c}`}:{}}),l=p.headers["content-disposition"];let d=`feedback_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;if(l){const r=l.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);if(r&&r[1]){d=r[1].replace(/['"]/g,"");try{d=decodeURIComponent(d)}catch{}}}const f=window.URL.createObjectURL(new Blob([p.data])),s=document.createElement("a");s.href=f,s.setAttribute("download",d),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(f),n.success("导出成功")}catch(a){if(console.error("导出反馈数据失败:",a),a.response?.data instanceof Blob){const o=new FileReader;o.onload=()=>{try{const c=JSON.parse(o.result);n.error(c.detail||"导出失败")}catch{n.error("导出失败")}},o.readAsText(a.response.data)}else n.error(a.response?.data?.detail||a.message||"导出失败");throw a}}export{k as e,b as g,w as s,g as u};
