import{y as F,r as f,j as e,s as H,B as u,Y as D,t as N,d as T,V as ie,W as ce,X as oe,R as L,Z as de,D as xe,o as he,v as me,p as ue,w as O,x as ge}from"./index-BkZ1fbvE.js";import{B}from"./badge-D8rsmH0n.js";import{S as fe}from"./scroll-area-Bi1TlHFu.js";import{D as U,a as ee,b as se,c as ae,d as le,e as pe,f as te,g as je}from"./dialog-DdHcYUWU.js";import{L as k}from"./label-BPYBCH7t.js";import{S as ve}from"./square-pen-DQXwvMiz.js";import{u as we,f as A,b as be,c as Ne,d as ye,e as _e}from"./index-BjZ7u3zq.js";import{D as Se,b as ke,c as Ce,d as De,f as ze,g as Te,I as W}from"./drawer-HN2_FTBb.js";import{S as P,a as V,b as q,c as $,d as C}from"./select-BVe2FuYJ.js";import{T as G,a as Ie,b as I,c as Me,d as Be,e as K}from"./table-D5oD5D8Z.js";import{T as M}from"./textarea-DZUYYOaG.js";import{I as Fe,a as Re,b as Le,c as Ke,d as Pe}from"./IconPlus-DCu00Qm-.js";import{D as Ve}from"./database-Dw3Xe9Nb.js";import"./index-BdQq_4o_.js";import"./index-JW4qzHJT.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],$e=F("circle-alert",qe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ee=F("clock",He);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],X=F("plus",Oe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],We=F("trash-2",Ae);function Y({type:l,item:t,onSave:r,trigger:y}){const[p,m]=f.useState(!1),[n,o]=f.useState(t||{name:"",created_at:new Date().toISOString().split("T")[0]});f.useEffect(()=>{p&&o(t||{name:"",created_at:new Date().toISOString().split("T")[0]})},[p,t]);const j=g=>{g.preventDefault(),r(n,l==="add"),m(!1)};return e.jsxs(U,{open:p,onOpenChange:m,children:[e.jsx(ee,{asChild:!0,children:y}),e.jsx(se,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:j,children:[e.jsxs(ae,{children:[e.jsx(le,{children:l==="add"?"新增批次":"编辑批次"}),e.jsx(pe,{children:l==="add"?"创建新的标注批次":"修改批次信息"})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(k,{htmlFor:"name",children:"批次名称"}),e.jsx(H,{id:"name",value:n.name,onChange:g=>o({...n,name:g.target.value}),placeholder:"输入批次名称",required:!0})]})}),e.jsxs(te,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>m(!1),children:"取消"}),e.jsx(u,{type:"submit",children:l==="add"?"创建":"保存"})]})]})})]})}async function Ge(l){try{return(await D.post("/v1/admin/knowledge-label/batch",l)).data}catch(t){throw N.error(t.message||"Failed to create knowledge label batch"),t}}async function Xe(l,t){try{const r=await D.put(`/v1/admin/knowledge-label/batch/${l}`,t);return N.success("知识标注批次更新成功"),r.data}catch(r){throw N.error(r.message||"Failed to update knowledge label batch"),r}}async function Ye(l){try{const t=await D.delete(`/v1/admin/knowledge-label/batch/${l}`);return N.success("知识标注批次删除成功"),t.data}catch(t){throw N.error(t.message||"Failed to delete knowledge label batch"),t}}async function Ze(){try{return(await D.get("/v1/admin/knowledge-label/batch")).data}catch(l){throw N.error(l.message||"Failed to fetch knowledge label batch"),l}}async function Je(l,t){try{const r=await D.post(`/v1/admin/knowledge-label/${l}/label-detail`,t);return N.success("知识标注条目创建成功"),r.data}catch(r){throw N.error(r.message||"Failed to create knowledge label"),r}}async function Qe(l,t){try{const r=await D.put(`/v1/admin/knowledge-label/${l}/label-detail`,t);return N.success("知识标注条目更新成功"),r.data}catch(r){throw N.error(r.message||"Failed to update knowledge label"),r}}async function Ue(l){try{return(await D.post("/v1/admin/knowledge-label/query",l)).data}catch(t){throw N.error(t.message||"Failed to fetch knowledge labels"),t}}const Z={pending:{label:"待处理",icon:$e,color:"text-muted-foreground",bgColor:"bg-muted"},active:{label:"进行中",icon:Ee,color:"text-blue-500",bgColor:"bg-blue-500/10"}};function es({loading:l,batchList:t,setBatchList:r,selectedBatchId:y,onSelectBatch:p,itemCount:m,completedCount:n,onDeleteSuccess:o}){const[j,g]=f.useState(null),[S,_]=f.useState(null),x=async(i,v)=>{if(v.stopPropagation(),confirm("确定要删除这个批次吗？"))try{await Ye(i),r(t.filter(d=>d.id!==i)),y===i&&p(null),o?.()}catch(d){console.error("删除批次失败:",d)}},h=async(i,v)=>{try{if(v){const d=await Ge({name:i.name}),w={...i,id:d.id,created_at:d.created_at.split("T")[0]};r(a=>[...a,w])}else{const d=await Xe(i.id,{name:i.name}),w={...i,name:i.name,created_at:d.created_at.split("T")[0]};r(a=>a.map(s=>s.id===i.id?w:s))}}catch(d){console.error(`${v?"创建":"更新"}批次失败:`,d)}};return l?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-2 border-b flex-shrink-0",children:e.jsxs(u,{className:"w-full",size:"sm",disabled:!0,children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"新增批次"]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("p",{children:"加载中..."})})]}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-2 border-b flex-shrink-0",children:e.jsx(Y,{type:"add",onSave:h,trigger:e.jsxs(u,{className:"w-full",size:"sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"新增批次"]})})}),e.jsx(fe,{className:"flex-1 min-h-0",children:e.jsx("div",{className:"p-2",children:t?.map(i=>{const v=i.id===y,d=i.id===j,w=m>0?n/m*100:0,a=w===100?"active":"pending",s=w===100?Z.active:Z.pending,c=s.icon;return e.jsxs("div",{onMouseEnter:()=>g(i.id),onMouseLeave:()=>g(null),className:T("relative group w-full text-left p-3 rounded-lg mb-2 transition-colors cursor-pointer","hover:bg-accent/50",v&&"bg-accent"),onClick:()=>p(i.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("h3",{className:T("font-medium text-sm leading-relaxed line-clamp-1 flex-1 pr-2",v?"text-foreground":"text-foreground/90"),children:[i.id,":",i.name]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{className:T("w-4 h-4 flex-shrink-0",s.color)}),(d||S===i.id)&&e.jsxs("div",{className:"flex gap-0.5 ml-1",children:[e.jsx(Y,{type:"edit",item:i,onSave:(b,R)=>{h(b,R),_(null)},trigger:e.jsx(u,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-primary/10",onClick:b=>{b.stopPropagation(),_(i.id)},children:e.jsx(ve,{className:"w-3 h-3"})})}),e.jsx(u,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-destructive/10 hover:text-destructive",onClick:b=>x(i.id,b),children:e.jsx(We,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n,"/",m," 已完成"]}),e.jsx(B,{variant:"secondary",className:T("text-xs",s.bgColor,s.color),children:s.label})]}),e.jsx("div",{className:"w-full h-1 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:T("h-full transition-all duration-300",a==="active"?"bg-blue-500":"bg-gray-300"),style:{width:`${w}%`}})}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["创建于 ",i.created_at.split("T")[0]]})]},i.id)})})})]})}function J({content:l}){const[t,r]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:e.jsxs(ie,{children:[e.jsx(ce,{asChild:!0,children:e.jsx("a",{className:"text-md line-clamp-3 leading-relaxed whitespace-normal break-words cursor-help text-xs text-muted-foreground",children:l})}),e.jsx(oe,{side:"top",className:"max-w-sm",children:e.jsx("span",{className:"text-xl leading-relaxed whitespace-pre-wrap",children:l})})]})}),e.jsx(Se,{direction:"right",open:t,onOpenChange:r,children:e.jsxs(ke,{children:[e.jsx(Ce,{children:e.jsx(De,{children:"内容详情"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap break-words font-sans",children:l})}),e.jsx(ze,{children:e.jsx(Te,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"关闭"})})})]})})]})}function Q({batchId:l,item:t,type:r,onSave:y}){const[p,m]=L.useState(!1),[n,o]=L.useState(!1),j=L.forwardRef(({children:x,...h},i)=>e.jsx("span",{ref:i,...h,children:x}));j.displayName="TriggerSpan";const g=()=>r==="add"?e.jsxs(u,{variant:"default",onClick:()=>m(!0),children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden lg:inline ml-2",children:"新增标注"})]}):e.jsx(j,{className:"inline-block max-w-full cursor-pointer hover:underline truncate",title:t?.question,children:t?.question}),S=x=>{switch(x){case"通过":return!0;case"未通过":return!1;default:return null}},_=x=>x===!0?"通过":x===!1?"未通过":"未审核";return e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(U,{open:p,onOpenChange:m,children:[e.jsx(ee,{asChild:!0,children:g()}),e.jsx(se,{className:"sm:max-w-[600px]",children:e.jsxs("form",{onSubmit:async x=>{x.preventDefault(),o(!0);try{const h=new FormData(x.target),i=h.get("question"),v=h.get("ai_content"),d=h.get("user_content"),w=h.get("is_passed"),a=h.get("description"),s=h.get("filled_by"),c=S(w);r==="add"?await Je(l||0,{name:i,ai_content:v,user_content:d,description:a,is_passed:c,filled_by:s}):await Qe(t.label_id,{name:i,ai_content:v,user_content:d,description:a,is_passed:c,filled_by:s}),y(),m(!1)}catch(h){console.error("保存标注失败:",h)}finally{o(!1)}},children:[e.jsx(ae,{className:"px-4 pt-4 pb-2",children:e.jsx(le,{children:r==="edit"?`编辑标注: ${t?.label_id}`:`批次号${l}：新增标注`})}),e.jsxs("div",{className:"px-4 pb-4 grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"question",children:"问题"}),e.jsx(M,{id:"question",name:"question",placeholder:"请输入问题",defaultValue:t?.question,className:"min-h-[80px]",required:!0})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"ai_content",children:"AI 生成的答案"}),e.jsx(M,{id:"ai_content",name:"ai_content",placeholder:"AI 生成的内容",defaultValue:t?.ai_content,className:"min-h-[100px]",required:!0})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"user_content",children:"用户的标注"}),e.jsx(M,{id:"user_content",name:"user_content",placeholder:"请输入用户的标注内容",defaultValue:t?.user_content,className:"min-h-[100px]",required:!0})]}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"description",children:"描述"}),e.jsx(M,{id:"description",name:"description",placeholder:"请输入描述信息",defaultValue:t?.description,className:"min-h-[80px]"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"is_passed",children:"是否通过"}),e.jsxs(P,{name:"is_passed",defaultValue:t?.is_passed!==void 0?_(t.is_passed):"",children:[e.jsx(V,{id:"is_passed",children:e.jsx(q,{placeholder:"请选择是否通过"})}),e.jsxs($,{children:[e.jsx(C,{value:"通过",children:"通过"}),e.jsx(C,{value:"未通过",children:"未通过"}),e.jsx(C,{value:"未审核",children:"未审核"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(k,{htmlFor:"filled_by",children:"填表人"}),e.jsx(H,{id:"filled_by",name:"filled_by",placeholder:"请输入填表人",defaultValue:t?.filled_by})]})]}),e.jsx(te,{className:"px-4 py-4 border-t",children:e.jsxs("div",{className:"flex justify-end gap-4 w-full",children:[e.jsx("div",{className:"w-24",children:e.jsx(je,{asChild:!0,children:e.jsx(u,{variant:"outline",className:"w-full",type:"button",children:"取消"})})}),e.jsx("div",{className:"w-24",children:e.jsx(u,{type:"submit",className:"w-full",disabled:n,children:n?"保存中...":"保存"})})]})})]})})]})})}const ss=l=>new Date(l).toLocaleDateString("zh-CN");function as({batchId:l,data:t,pagination:r,loading:y=!1,searchParams:p,onSearch:m,onReset:n,onPageChange:o,onPageSizeChange:j}){const g=[{accessorKey:"label_id",header:()=>e.jsx("span",{className:"text-muted-foreground",children:"ID"}),cell:({row:a})=>e.jsx("div",{className:"truncate break-words leading-tight",children:a.original.label_id}),enableSorting:!0,enableHiding:!1,size:80},{accessorKey:"question",header:"问题",cell:({row:a})=>e.jsx("div",{className:"text-xs text-muted-foreground",children:e.jsx(Q,{batchId:l,item:a.original,type:"edit",onSave:n})}),enableHiding:!0,size:320},{accessorKey:"ai_content",header:"AI 内容",cell:({row:a})=>a.original.ai_content?e.jsx(J,{content:a.original.ai_content}):e.jsx("span",{className:"text-muted-foreground",children:"暂无内容"}),size:320},{accessorKey:"user_content",header:"人工标注",cell:({row:a})=>a.original.user_content?e.jsx(J,{content:a.original.user_content}):e.jsx("span",{className:"text-muted-foreground",children:"无"}),size:320},{accessorKey:"is_passed",header:"审核状态",cell:({row:a})=>{const s=a.original.is_passed;return s===!0?e.jsxs(B,{variant:"outline",className:"text-muted-foreground px-1.5",children:[e.jsx(W,{className:"fill-green-500 dark:fill-green-400"}),"已通过"]}):s===!1?e.jsxs(B,{variant:"outline",className:"text-muted-foreground px-1.5",children:[e.jsx(W,{className:"fill-red-500 dark:fill-red-400"}),"未通过"]}):e.jsx(B,{variant:"outline",className:"text-muted-foreground px-1.5",children:"待审核"})},size:80},{accessorKey:"filled_by",header:"填写人",cell:({row:a})=>e.jsx("span",{className:"text-muted-foreground",children:a.original.filled_by||"-"}),size:100},{accessorKey:"create_at",header:"创建时间",cell:({row:a})=>e.jsx("span",{className:"text-muted-foreground",children:ss(a.original.create_at)}),sortingFn:"datetime",size:60},{id:"actions",cell:({})=>e.jsxs(xe,{children:[e.jsx(he,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"size-8 text-muted-foreground",children:e.jsx(me,{})})}),e.jsxs(ue,{align:"end",className:"w-32",children:[e.jsx(O,{children:"编辑"}),e.jsx(ge,{}),e.jsx(O,{className:"text-destructive",children:"删除"})]})]}),size:60}],[S,_]=f.useState(p.name),[x,h]=f.useState({}),i=we({data:t,columns:g,state:{rowSelection:x},enableRowSelection:!0,onRowSelectionChange:h,getCoreRowModel:_e(),getFilteredRowModel:ye(),getPaginationRowModel:Ne(),getSortedRowModel:be()}),v=()=>m(S,p.pass_state),d=a=>a.key==="Enter"&&v(),w=Math.ceil(r.total/r.size);return e.jsxs("div",{className:"w-full h-full flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-6 py-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground"}),e.jsxs("div",{className:"w-2/3 flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(de,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(H,{placeholder:"搜索...",value:S,onChange:a=>_(a.target.value),onKeyDown:d,className:"pl-8"})]}),e.jsxs(P,{value:p.pass_state,onValueChange:a=>{m(S,a)},children:[e.jsx(V,{className:"w-32",children:e.jsx(q,{placeholder:"类型"})}),e.jsxs($,{children:[e.jsx(C,{value:"all",children:"全部"}),e.jsx(C,{value:"passed",children:"通过"}),e.jsx(C,{value:"unpassed",children:"未通过"}),e.jsx(C,{value:"unchecked",children:"待审核"})]})]}),e.jsx(u,{onClick:v,children:"搜索"}),e.jsx(u,{variant:"secondary",onClick:()=>{_(""),n()},children:"重置"}),e.jsx(Q,{batchId:l,type:"add",onSave:n})]})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"overflow-hidden rounded-lg border flex-1 flex flex-col",children:[e.jsx("div",{className:"overflow-hidden",children:e.jsxs(G,{className:"w-full table-fixed",children:[e.jsx("colgroup",{children:g.map((a,s)=>e.jsx("col",{style:{width:a.size}},s))}),e.jsx(Ie,{className:"bg-muted",children:i.getHeaderGroups().map(a=>e.jsx(I,{children:a.headers.map(s=>e.jsx(Me,{colSpan:s.colSpan,className:"align-middle",children:s.isPlaceholder?null:A(s.column.columnDef.header,s.getContext())},s.id))},a.id))})]})}),e.jsx("div",{className:"overflow-auto flex-1",children:e.jsxs(G,{className:"w-full table-fixed",children:[e.jsx("colgroup",{children:g.map((a,s)=>e.jsx("col",{style:{width:a.size}},s))}),e.jsx(Be,{children:y?e.jsx(I,{children:e.jsx(K,{colSpan:g.length,className:"h-24 text-center",children:"加载中..."})}):i.getRowModel().rows.length?i.getRowModel().rows.map(a=>e.jsx(I,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(K,{className:"align-middle py-2",children:A(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(I,{children:e.jsx(K,{colSpan:g.length,className:"h-24 text-center",children:"无数据"})})})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t shrink-0",children:[e.jsxs("div",{className:"text-muted-foreground hidden flex-1 text-sm lg:flex",children:["共 ",r.total," 条数据"]}),e.jsxs("div",{className:"flex w-full items-center gap-8 lg:w-fit",children:[e.jsxs("div",{className:"hidden items-center gap-2 lg:flex",children:[e.jsx(k,{htmlFor:"rows-per-page",className:"text-sm font-medium",children:"每页行数"}),e.jsxs(P,{value:`${p.size}`,onValueChange:a=>{j(Number(a)),i.setPageSize(Number(a))},children:[e.jsx(V,{className:"w-20",size:"sm",id:"rows-per-page",children:e.jsx(q,{})}),e.jsx($,{side:"top",children:[10,20,30,40,50].map(a=>e.jsx(C,{value:`${a}`,children:a},a))})]})]}),e.jsxs("div",{className:"text-sm font-medium",children:["第 ",r.page," 页，共 ",w," 页"]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 lg:ml-0",children:[e.jsx(u,{variant:"outline",className:"hidden lg:flex size-8",size:"icon",onClick:()=>o(1),disabled:r.page<=1,children:e.jsx(Re,{className:"size-4"})}),e.jsx(u,{variant:"outline",className:"size-8",size:"icon",onClick:()=>o(r.page-1),disabled:r.page<=1,children:e.jsx(Le,{className:"size-4"})}),e.jsx(u,{variant:"outline",className:"size-8",size:"icon",onClick:()=>o(r.page+1),disabled:!r.hasNext,children:e.jsx(Ke,{className:"size-4"})}),e.jsx(u,{variant:"outline",className:"hidden lg:flex size-8",size:"icon",onClick:()=>o(w),disabled:!r.hasNext||r.page>=w,children:e.jsx(Pe,{className:"size-4"})})]})]})]})]})})]})}function js(){const[l,t]=f.useState(null),[r,y]=f.useState([]),[p,m]=f.useState(!0),[n,o]=f.useState({batch_id:1,name:"",pass_state:"all",filled_by:"",page:1,size:10}),[j,g]=f.useState({items:[],total:0,page:1,size:10,has_next:!1,has_prev:!1}),[S,_]=f.useState(!1),x=async(s,c,b="all",R,ne=1,re=10)=>{try{_(!0);const z=await Ue({batch_id:s,name:c,pass_state:b,filled_by:R,page:ne,size:re});g({items:z.items,total:z.total,page:z.page,size:z.size,has_next:z.has_next,has_prev:z.has_prev})}catch(E){console.error("获取标注清单失败:",E),N.error("获取标注清单失败")}finally{_(!1)}},h=async()=>{try{m(!0);const s=await Ze();if(y(s),s.length>0){const c=s[0].id;t(c),o(b=>({...b,batch_id:c})),x(c,n.name,n.pass_state,n.filled_by,n.page,n.size)}}catch(s){console.error("获取批次列表失败:",s),N.error("获取批次列表失败")}finally{m(!1)}};f.useEffect(()=>{h()},[]);const i=s=>{t(s),s!==null&&(o(c=>({...c,batch_id:s,page:1,name:""})),x(s,n.name,n.pass_state,n.filled_by,n.page,n.size))},v=(s,c)=>{l!==null&&(o(b=>({...b,page:1,name:s!==void 0?s:b.name,pass_state:c!==void 0?c:b.pass_state})),x(l,s!==void 0?s:n.name,c!==void 0?c:n.pass_state,n.filled_by,n.page,n.size))},d=()=>{l!==null&&o(s=>({...s,name:"",pass_state:"all",page:1,size:10}))},w=s=>{l!==null&&o(c=>({...c,page:s}))},a=s=>{l!==null&&o(c=>({...c,page:1,size:s}))};return f.useEffect(()=>{l!==null&&x(l,n.name,n.pass_state,n.filled_by,n.page,n.size)},[n,l]),e.jsxs("div",{className:"flex gap-2 h-full",children:[e.jsxs("div",{className:"h-full flex-[1] min-w-[200px] border-r border-border bg-card flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ve,{className:"w-5 h-5 text-primary"}),e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"机器人测试"})]})}),e.jsx(es,{loading:p,batchList:r,setBatchList:y,selectedBatchId:l,onSelectBatch:i,itemCount:0,completedCount:0,onDeleteSuccess:h})]}),e.jsx("div",{className:"flex-[5] flex flex-col h-full",children:e.jsx(as,{batchId:l,data:j.items,pagination:{total:j.total,page:j.page,size:j.size,hasNext:j.has_next,hasPrev:j.has_prev},loading:S,searchParams:{batch_id:n.batch_id,name:n.name,pass_state:n.pass_state,filled_by:n.filled_by,page:n.page,size:n.size},onSearch:v,onReset:d,onPageChange:w,onPageSizeChange:a})})]})}export{js as default};
