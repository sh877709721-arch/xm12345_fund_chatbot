import{r,j as e,s as p,B as h,t}from"./index-BkZ1fbvE.js";import{L as l}from"./label-BPYBCH7t.js";import{m as u}from"./guideline-Bbhb0vb9.js";import{L as f}from"./loader-circle-qc_e4yNT.js";import{S as j}from"./search-CLI9qL7o.js";function w(){const[d,o]=r.useState(""),[c,i]=r.useState(!1),[s,m]=r.useState(null),x=a=>{a.key==="Enter"&&n()},n=async()=>{if(!d.trim()){t.error("请输入测试上下文");return}i(!0),m(null);try{const a=await u({context:d,candidate_top_k:5,use_llm_refinement:!0});a?(m(a),t.success("匹配成功")):t.info("未找到匹配的指南")}catch(a){console.error("匹配测试失败:",a),a.message==="请求超时，请检查网络连接"?t.error("请求超时，请检查网络连接后重试"):a.response?.data?.detail?t.error(a.response.data.detail):t.error("匹配失败，请重试")}finally{i(!1)}};return e.jsxs("div",{className:"w-full h-full flex flex-col gap-6",children:[e.jsx("div",{className:"px-4 lg:px-6 py-4 border-b",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 lg:gap-6 items-start",children:[e.jsx("div",{className:"flex-1 space-y-2",children:e.jsx("h4",{className:"text-2xl font-bold tracking-tight",children:"Guideline 匹配测试"})}),e.jsxs("div",{className:"flex-4 max-w-6xl",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{placeholder:"输入对话上下文或用户查询，例如：为什么今年公积金缴存基数调整了",value:d,onChange:a=>o(a.target.value),onKeyDown:x,className:"flex-1"}),e.jsxs(h,{onClick:n,disabled:c||!d.trim(),className:"px-6",children:[c?e.jsx(f,{className:"w-4 h-4 animate-spin"}):e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-2",children:"匹配测试"})]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"根据对话上下文匹配，获取AI的行动指南"})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto px-4 lg:px-6",children:e.jsx("div",{className:"max-w-4xl mx-auto space-y-6 pb-6",children:s&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"border-b pb-2",children:e.jsx("h2",{className:"text-xl font-semibold",children:"匹配结果"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"匹配 ID"}),e.jsx("p",{className:"font-semibold text-lg",children:s.guideline_id})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"置信度"}),e.jsx("p",{className:"font-semibold text-lg",children:s.confidence?`${(s.confidence*100).toFixed(1)}%`:"N/A"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"标题"}),e.jsx("p",{className:"font-semibold text-lg",children:s.title})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"触发条件"}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg border",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:s.condition})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"行动内容"}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg border",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed",children:s.action})})]}),s.prompt_template&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"Prompt 模板"}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg border",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap leading-relaxed font-mono",children:s.prompt_template})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"匹配得分"}),e.jsx("p",{className:"font-semibold",children:s.match_score?.toFixed(3)||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"匹配方式"}),e.jsx("p",{className:"font-semibold",children:s.match_method})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{className:"text-sm text-muted-foreground font-medium",children:"优先级"}),e.jsx("p",{className:"font-semibold",children:s.priority})]})]})]})]})})})]})}export{w as GuidelineMatchTestPage,w as default};
