import{r as i,O as C,Q as L,z,j as e,d as I,s as v,B as D,t as x,T as H,U as T}from"./index-BkZ1fbvE.js";import{L as y}from"./label-BPYBCH7t.js";import{C as q,a as A,b as B,c as E,e as F}from"./card-CXEOfyPU.js";function P({className:f}){const[r,d]=i.useState(""),[a,c]=i.useState(""),[n,t]=i.useState(!1),[l,j]=i.useState(0),w=C(),$=L(),{login:M}=z(),N=$.state?.from?.pathname||"/admin",[u,h]=i.useState(0),[S,b]=i.useState(!1),g=u===0&&!n&&!S;i.useEffect(()=>{if(l===0){h(0);return}const o=setInterval(()=>{const p=Date.now()-l,s=Math.max(0,2e3-p);h(s),s<=0&&(clearInterval(o),h(0))},100);return()=>clearInterval(o)},[l]);const k=async o=>{if(o.preventDefault(),!g){const s=Math.ceil(u/1e3);x.error(`请等待${s}秒后再试，避免频繁操作`);return}if(!r.trim()||!a.trim()){x.error("请输入邮箱和密码");return}t(!0),b(!0);const p=Date.now();j(p),h(2e3);try{await H({username:r,password:a}),x.success("登录成功");const s=await T();console.log("当前用户:",s),M(s),w(N,{replace:!0})}catch(s){console.error("登录错误:",s);let m="登录失败";s.response?.status===401?m="用户名或密码错误":s.response?.status===429?m="请求过于频繁，请稍后再试":s.response?.status>=500?m="服务器错误，请稍后再试":s.message&&(m=s.message),x.error(m)}finally{t(!1),b(!1)}};return e.jsx("div",{className:I("flex flex-col gap-6",f),children:e.jsxs(q,{children:[e.jsxs(A,{className:"text-center",children:[e.jsx(B,{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"欢迎回来"}),e.jsx(E,{className:"text-gray-600 dark:text-gray-400",children:"登录你的账号"})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",className:"text-gray-700 dark:text-gray-300 font-medium",children:"邮箱"}),e.jsx(v,{id:"email",type:"email",placeholder:"m@example.com",onChange:o=>d(o.target.value),value:r,required:!0,className:"h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(y,{htmlFor:"password",className:"text-gray-700 dark:text-gray-300 font-medium",children:"密码"})}),e.jsx(v,{id:"password",type:"password",value:a,onChange:o=>c(o.target.value),required:!0,className:"h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400"})]}),e.jsx(D,{type:"submit",className:"w-full h-11 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-md hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:n||!g,children:n?"登录中...":!g&&u>0?`请等待 ${Math.ceil(u/1e3)}s`:"登录"})]})})]})})}function R(){const r=d=>(210+d+360)%360;return e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none z-0",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`
            linear-gradient(to right, hsla(${r(-15)}, 100%, 60%, 0.25) 1px, transparent 1px),
            linear-gradient(to bottom, hsla(${r(0)}, 94%, 60%, 0.25) 1px, transparent 1px)
          `,backgroundSize:"60px 60px"}}),e.jsx("div",{className:"absolute inset-0",children:[...Array(20)].map((d,a)=>{const c=60+Math.sin(a*1.7)*25+Math.cos(a*2.3)*15,n=55+Math.cos(a*1.3)*30+Math.sin(a*3.1)*20,t=15+Math.sin(a*2.7)*10,l=r(-10+a%5*4);return e.jsx("div",{className:"absolute",style:{left:`${Math.max(55,Math.min(95,c))}%`,top:`${Math.max(50,Math.min(95,n))}%`,width:`${t}px`,height:`${t}px`,animationDelay:`${Math.random()*5}s`,animation:`spinSlow ${15+Math.random()*10}s linear infinite`},children:e.jsx("div",{className:"w-full h-full border-2 opacity-50 transform rotate-45",style:{borderColor:`hsl(${l}, 100%, ${55+a%2*10}%)`,boxShadow:`0 0 ${12+t/2}px hsl(${l}, 100%, ${50+a%2*10}%)`,filter:`blur(0.5px) drop-shadow(0 0 ${8+t/3}px hsl(${l}, 100%, 55%))`}})},`square-${a}`)})}),e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(5)].map((d,a)=>{const c=45+Math.sin(a*2.1)*30+Math.cos(a*3.7)*15,n=Math.random()>.4,t=r(-10+a*7%12);return e.jsx("div",{className:`absolute animate-pulse ${n?"h-[1px] w-full":"w-[1px] h-full"}`,style:{background:`linear-gradient(${n?"90deg":"180deg"},
                  transparent,
                  hsla(${t}, 100%, 65%, ${.6+Math.random()*.3}),
                  hsla(${r(5)}, 100%, 50%, ${.5+Math.random()*.3}),
                  transparent)`,[n?"top":"left"]:`${Math.max(40,Math.min(90,c))}%`,filter:`blur(${.6+Math.random()*1}px) brightness(1.4)`,boxShadow:`0 0 ${8+Math.random()*12}px hsla(${t}, 100%, 60%, 0.7)`,animation:`scanLine ${6+Math.random()*8}s ease-in-out infinite ${Math.random()*2}s`,opacity:.4+Math.random()*.5}},`scan-${a}`)})})]})}function O(){return e.jsxs("div",{className:"relative min-h-svh w-full",children:[e.jsx(R,{}),e.jsx("div",{className:"relative z-10 flex min-h-svh w-full items-center justify-center p-6 md:p-10",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-white/80 backdrop-blur-xl shadow-2xl"}),e.jsx("div",{className:"relative z-10",children:e.jsx(P,{})})]})})})]})}export{O as default};
